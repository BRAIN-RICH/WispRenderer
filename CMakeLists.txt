cmake_minimum_required(VERSION 3.13)

set_property(GLOBAL PROPERTY USE_FOLDERS ON)

project(EnginePrototype)

if (MSVC)
	add_compile_options(/W4)
endif()

##### OUTPUT DIRECTORIES #####
set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/lib)
set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/lib)
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/bin)

##### DEPENDENCIES #####
file(GLOB HEADERS "${CMAKE_CURRENT_SOURCE_DIR}/src/*.hpp" [CONFIGURE_DEPENDS])
file(GLOB SOURCES "${CMAKE_CURRENT_SOURCE_DIR}/src/*.cpp" [CONFIGURE_DEPENDS])
file(GLOB FG_HEADERS "${CMAKE_CURRENT_SOURCE_DIR}/src/frame_graph/*.hpp" [CONFIGURE_DEPENDS])
file(GLOB FG_SOURCES "${CMAKE_CURRENT_SOURCE_DIR}/src/frame_graph/*.cpp" [CONFIGURE_DEPENDS])
file(GLOB SG_HEADERS "${CMAKE_CURRENT_SOURCE_DIR}/src/scene_graph/*.hpp" [CONFIGURE_DEPENDS])
file(GLOB SG_SOURCES "${CMAKE_CURRENT_SOURCE_DIR}/src/scene_graph/*.cpp" [CONFIGURE_DEPENDS])
file(GLOB RT_HEADERS "${CMAKE_CURRENT_SOURCE_DIR}/src/render_tasks/*.hpp" [CONFIGURE_DEPENDS])
file(GLOB RT_SOURCES "${CMAKE_CURRENT_SOURCE_DIR}/src/render_tasks/*.cpp" [CONFIGURE_DEPENDS])
file(GLOB D3D12_HEADERS "${CMAKE_CURRENT_SOURCE_DIR}/src/d3d12/*.hpp" [CONFIGURE_DEPENDS])
file(GLOB D3D12_SOURCES "${CMAKE_CURRENT_SOURCE_DIR}/src/d3d12/*.cpp" [CONFIGURE_DEPENDS])
file(GLOB UTIL_HEADERS "${CMAKE_CURRENT_SOURCE_DIR}/src/util/*.hpp" [CONFIGURE_DEPENDS])
file(GLOB UTIL_SOURCES "${CMAKE_CURRENT_SOURCE_DIR}/src/util/*.cpp" [CONFIGURE_DEPENDS])

source_group("High Level API" FILES ${SOURCES} ${HEADERS})
source_group("Frame Graph" FILES ${FG_SOURCES} ${FG_HEADERS})
source_group("Scene Graph" FILES ${SG_SOURCES} ${SG_HEADERS})
source_group("Render Tasks" FILES ${RT_SOURCES} ${RT_HEADERS})
source_group("D3D12" FILES ${D3D12_SOURCES} ${D3D12_HEADERS})
source_group("Utility" FILES ${UTIL_SOURCES} ${UTIL_HEADERS})

add_executable(EnginePrototype ${HEADERS} ${SOURCES} ${UTIL_HEADERS} ${UTIL_SOURCES}  ${RT_HEADERS} ${RT_SOURCES} ${FG_HEADERS} ${FG_SOURCES} ${SG_HEADERS} ${SG_SOURCES} ${D3D12_SOURCES} ${D3D12_HEADERS})
target_link_libraries(EnginePrototype dxguid.lib d3d12.lib dxgi.lib d3dcompiler.lib)
set_target_properties(EnginePrototype PROPERTIES CXX_STANDARD 17)

set_property(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR} PROPERTY VS_STARTUP_PROJECT EnginePrototype)
set_target_properties(EnginePrototype PROPERTIES VS_DEBUGGER_WORKING_DIRECTORY "${CMAKE_BINARY_DIR}/../")
